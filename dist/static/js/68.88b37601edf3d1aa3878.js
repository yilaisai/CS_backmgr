webpackJsonp([68],{"2WtA":function(e,t){},ixX9:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s("mvHQ"),r=s.n(l),i={name:"ruleSetting",data:function(){return{coinList:[],registList:[],dialogTitle:"",dialogFormVisible:!1,ruleForm:{coinId:"",lower:"",middle:"",senior:"",service:"",peers:""},rules:{coinId:[{required:!0,message:"请选择币种",trigger:"change"}],lower:[{required:!0,message:"请输入初级代理提成",trigger:"blur"}],middle:[{required:!0,message:"请输入中级代理提成",trigger:"blur"}],senior:[{required:!0,message:"请输入高级代理提成",trigger:"blur"}],service:[{required:!0,message:"请输入服务中心提成",trigger:"blur"}],peers:[{required:!0,message:"请输入平级补助",trigger:"blur"}]}}},methods:{remove:function(e){var t=this,s=e.id;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.delete("/cloud/backmgr/shop/deleteAgencyRuleById",{id:s}).then(function(e){t.$notify({title:"成功",message:"删除成功",type:"success"}),t.getList()})})},registerSwitchChange:function(e){var t=this,s=e.state,l=e.id;this.$http.get("/cloud/backmgr/shop/updateRuleStatus",{status:s?"enable":"disable",id:l}).then(function(e){t.$notify({title:"成功",message:(s?"上架":"下架")+" 成功",type:"success"}),t.getList()}).catch(function(){t.getList()})},addSend:function(){this.dialogTitle="新建返佣规则",this.dialogFormVisible=!0,this.$refs.ruleForm&&this.$refs.ruleForm.resetFields()},modification:function(e){this.dialogTitle="修改返佣规则",this.dialogFormVisible=!0,this.isFix=!0,this.ruleForm=JSON.parse(r()(e)),this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.getSampleCoinInfo()},registDetermine:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;var s=e.ruleForm,l=s.coinId,r=s.id,i=s.lower,o=s.middle,n=s.senior,a=s.service,u=s.peers;e.ruleForm.id?e.$http.put("/cloud/backmgr/shop/updateAgencyRule",{coinId:l,id:r,lower:i/100,middle:o/100,senior:n/100,service:a/100,peers:u/100}).then(function(t){e.$notify({title:"成功",message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}):e.$http.post("/cloud/backmgr/shop/addAgencyRule",{coinId:l,lower:i/100,middle:o/100,senior:n/100,service:a/100,peers:u/100}).then(function(t){e.$notify({title:"成功",message:"创建成功",type:"success"}),e.dialogFormVisible=!1,e.getList()})})},getSampleCoinInfo:function(){var e=this;this.$http.post("wallet/backmgr/coin/getSampleCoinInfo.do",{}).then(function(t){e.coinList=t.result.list})},getList:function(){var e=this;this.$http.post("/cloud/backmgr/shop/listAgencyRule",{pageNum:1,pageSize:200}).then(function(t){e.registList=t.result.list})}},activated:function(){this.getList(),this.getSampleCoinInfo()}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ruleSetting"},[s("el-col",{staticStyle:{"text-align":"right","margin-bottom":"10px"},attrs:{span:22}},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addSend}},[e._v("创建规则")])],1),e._v(" "),s("sac-table",{attrs:{data:e.registList}},[s("el-table-column",{attrs:{prop:"coinId",label:"返佣币种"}}),e._v(" "),s("el-table-column",{attrs:{prop:"lower",label:"初级代理提成"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(100*t.row.lower)+"%\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"middle",label:"中级代理提成"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(100*t.row.middle)+"%\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"senior",label:"高级代理提成"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(100*t.row.senior)+"%\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"service",label:"服务中心提成"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(100*t.row.service)+"%\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"peers",label:"平级补助"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(100*t.row.peers)+"%\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"上架"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"inactive-value":0,"active-value":1},nativeOn:{click:function(s){e.registerSwitchChange(t.row)}},model:{value:t.row.state,callback:function(s){e.$set(t.row,"state",s)},expression:"scope.row.state"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"success",size:"small"},nativeOn:{click:function(s){e.modification(t.row)}}},[e._v("修改\n        ")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(s){e.remove(t.row)}}},[e._v("删除\n        ")])]}}])})],1),e._v(" "),s("el-dialog",{staticClass:"register_dialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"135px"}},[s("el-form-item",{staticClass:"from_box_item",attrs:{label:"返佣币种：",prop:"coinId",size:"small"}},[s("el-select",{attrs:{placeholder:"请选择返佣币种"},model:{value:e.ruleForm.coinId,callback:function(t){e.$set(e.ruleForm,"coinId",t)},expression:"ruleForm.coinId"}},e._l(e.coinList,function(e){return s("el-option",{key:e.coinId,attrs:{label:e.coinName,value:e.coinId}})}))],1),e._v(" "),s("el-form-item",{staticClass:"from_box_item",attrs:{label:"初级代理提成：",prop:"lower"}},[s("el-input",{attrs:{type:"number",size:"small",placeholder:""},model:{value:e.ruleForm.lower,callback:function(t){e.$set(e.ruleForm,"lower",t)},expression:"ruleForm.lower"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),e._v(" "),s("el-form-item",{staticClass:"from_box_item",attrs:{label:"中级代理提成：≤",prop:"middle"}},[s("el-input",{attrs:{type:"number",size:"small",placeholder:""},model:{value:e.ruleForm.middle,callback:function(t){e.$set(e.ruleForm,"middle",t)},expression:"ruleForm.middle"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),e._v(" "),s("el-form-item",{staticClass:"from_box_item",attrs:{label:"高级代理提成：",prop:"senior"}},[s("el-input",{attrs:{type:"number",size:"small",placeholder:""},model:{value:e.ruleForm.senior,callback:function(t){e.$set(e.ruleForm,"senior",t)},expression:"ruleForm.senior"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),e._v(" "),s("el-form-item",{staticClass:"from_box_item",attrs:{label:"服务中心提成：",prop:"service"}},[s("el-input",{attrs:{type:"number",size:"small",placeholder:""},model:{value:e.ruleForm.service,callback:function(t){e.$set(e.ruleForm,"service",t)},expression:"ruleForm.service"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1),e._v(" "),s("el-form-item",{staticClass:"from_box_item",attrs:{label:"平级补助：",prop:"peers"}},[s("el-input",{attrs:{type:"number",size:"small",placeholder:""},model:{value:e.ruleForm.peers,callback:function(t){e.$set(e.ruleForm,"peers",t)},expression:"ruleForm.peers"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.registDetermine}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=s("VU/8")(i,o,!1,function(e){s("2WtA")},null,null);t.default=n.exports}});