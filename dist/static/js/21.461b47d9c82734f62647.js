webpackJsonp([21],{o8iE:function(e,t){},ublg:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("mvHQ"),i=l.n(a),o={name:"calculate",data:function(){var e=function(e,t,l){/^[0-9]+.?[0-9]*$/.test(t)?l():l(new Error(e.message))};return{pageNum:1,pageSize:20,listData:{total:null,list:[]},dialogTitle:"",dialogFormVisible:!1,ruleForm:{minAmount:"",maxAmount:"",powerValue:""},rules:{minAmount:[{required:!0,message:"请输入数额",trigger:"blur"},{validator:e,message:"大于等于必须为数字"}],maxAmount:[{required:!0,message:"请输入数额",trigger:"blur"},{validator:e,message:"小于等于必须为数字"}],powerValue:[{required:!0,message:"请输入初始算力",trigger:"blur"},{validator:e,message:"初始算力必须为数字"}]}}},methods:{resetForm:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields()},getPaginationChange:function(e,t){this.pageSize=e,this.pageNum=t,this.getComputePowerRule()},formatSex:function(e,t){return">="+e.minAmount+"  <="+e.maxAmount},getComputePowerRule:function(){var e=this,t=this.pageNum,l=this.pageSize;this.$http.post("wallet/backmgr/computePower/getComputePowerRule.do",{pageNum:t,pageSize:l}).then(function(t){var l=t.result.list,a=l.list,i=l.total;e.listData.list=a,e.listData.total=i})},switchChange:function(e){var t=this,l=e.isOnshelf,a=e.id;this.$http.post("wallet/backmgr/computePower/updateComputePowerRuleIsOnShelf.do",{isOnShelf:l?"YES":"NO",id:a}).then(function(e){t.$notify({title:"成功",message:(l?"上架":"下架")+" 成功",type:"success"}),t.getComputePowerRule()})},remove:function(e){var t=this,l=e.id;e.minAmount;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("wallet/backmgr/computePower/updateComputePowerRuleStatus.do",{status:"INVALID0",id:l}).then(function(e){t.$notify({title:"成功",message:"删除成功",type:"success"}),t.getComputePowerRule()})})},addCalculate:function(){this.dialogTitle="创建算力规则",this.dialogFormVisible=!0,this.resetForm()},modification:function(e){this.dialogTitle="修改算力规则",this.dialogFormVisible=!0,this.resetForm(),this.ruleForm=JSON.parse(i()(e))},determine:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;e.ruleForm.id?e.$http.post("wallet/backmgr/computePower/updateComputePowerRule.do",e.ruleForm).then(function(t){e.$notify({title:"成功",message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.getComputePowerRule()}):e.$http.post("wallet/backmgr/computePower/createComputePowerRule.do",e.ruleForm).then(function(t){e.$notify({title:"成功",message:"创建成功",type:"success"}),e.dialogFormVisible=!1,e.getComputePowerRule()})})}},activated:function(){this.getComputePowerRule()}},s={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"calculate"},[l("el-col",{staticStyle:{"text-align":"right","margin-bottom":"30px"},attrs:{span:22}},[l("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addCalculate}},[e._v("创建算力")])],1),e._v(" "),l("sac-table",{attrs:{data:e.listData.list}},[l("el-table-column",{attrs:{prop:"minAmount",label:"持币数量",formatter:e.formatSex}}),e._v(" "),l("el-table-column",{attrs:{prop:"powerValue",label:"初始算力"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"success",disabled:0!=t.row.isOnshelf,size:"small"},nativeOn:{click:function(l){e.modification(t.row)}}},[e._v("修改\n        ")]),e._v(" "),l("el-button",{attrs:{type:"danger",disabled:0!=t.row.isOnshelf,size:"small"},nativeOn:{click:function(l){e.remove(t.row)}}},[e._v("\n          删除\n        ")])]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"上架",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"inactive-value":0,"active-value":1},nativeOn:{click:function(l){e.switchChange(t.row)}},model:{value:t.row.isOnshelf,callback:function(l){e.$set(t.row,"isOnshelf",l)},expression:"scope.row.isOnshelf"}})]}}])})],1),e._v(" "),l("sac-pagination",{directives:[{name:"show",rawName:"v-show",value:e.listData.list.length>0,expression:"listData.list.length>0"}],attrs:{total:+e.listData.total,"page-size":e.pageSize,"current-page":e.pageNum},on:{handleChange:e.getPaginationChange}}),e._v(" "),l("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"130px"}},[l("el-form-item",{attrs:{label:"持币数量:",required:""}},[l("el-col",{attrs:{span:11}},[l("el-form-item",{attrs:{prop:"minAmount"}},[l("span",{staticClass:"input-before-lable1"},[e._v("大于等于")]),e._v(" "),l("el-input",{staticClass:"min-input",staticStyle:{width:"130px"},attrs:{clearable:"",size:"small",placeholder:"请输入数额"},model:{value:e.ruleForm.minAmount,callback:function(t){e.$set(e.ruleForm,"minAmount",t)},expression:"ruleForm.minAmount"}})],1)],1),e._v(" "),l("el-col",{staticClass:"line",attrs:{span:2}}),e._v(" "),l("el-col",{attrs:{span:11}},[l("el-form-item",{attrs:{prop:"maxAmount"}},[l("span",{staticClass:"input-before-lable"},[e._v("小于等于")]),e._v(" "),l("el-input",{staticClass:"min-input",staticStyle:{width:"130px"},attrs:{clearable:"",size:"small",placeholder:"请输入数额"},model:{value:e.ruleForm.maxAmount,callback:function(t){e.$set(e.ruleForm,"maxAmount",t)},expression:"ruleForm.maxAmount"}})],1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"初始算力:",prop:"powerValue"}},[l("el-input",{attrs:{size:"small",placeholder:"请输入数额"},model:{value:e.ruleForm.powerValue,callback:function(t){e.$set(e.ruleForm,"powerValue",t)},expression:"ruleForm.powerValue"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.determine}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=l("VU/8")(o,s,!1,function(e){l("o8iE")},null,null);t.default=r.exports}});