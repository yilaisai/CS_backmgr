webpackJsonp([65],{"/kWS":function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});l("oTFt"),l("9GaO"),l("v/ij");var a=l("aiqZ"),n=l("r+cd"),r=l.n(n),o={data:function(){return{pageTypeList:[],postObj:{url:"",title:"",content:"",pageType:1},rules:{pageType:[{required:!0,message:"请输入用户账户",trigger:"change"}],title:[{required:!0,message:"请输入用标题",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}]},disabled:!1,originUrl:"",uploadData:{},photoUrl:"",uploadType:"",serverPath:"",fullscreenLoading:!1}},methods:{save:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;var l="/wallet/backmgr/page/createPageInfo";e.postObj.id&&(l="/wallet/backmgr/page/updatePageInfo"),""!=e.postObj.url.trim()&&e.postObj.url!==e.originUrl&&""!=e.postObj.content.trim()?e.$confirm("修改外部URL后将清空自定义内容并保存，确定继续操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.postObj.content="",e.saveSubmit(l)}).catch(function(){e.$message({type:"info",message:"已取消"})}):e.saveSubmit(l)})},getPageType:function(){var e=this;this.$http.post("/wallet/backmgr/page/open/getPageTypeList").then(function(t){e.pageTypeList=t.result.list})},getContent:function(e){var t=this;this.$http.post("/wallet/backmgr/page/open/getPageInfo",{id:e}).then(function(e){t.postObj.content=e.result.appPageInfo.content||""})},saveSubmit:function(e){var t=this;this.$http.post(e,this.postObj).then(function(e){200==e.code&&t.$notify({title:"成功",message:e.msg,type:"success"}),t.$router.go(-1)})},beforeUpload:function(e){if(e.size>1048576)return this.$notify({title:"提示",message:"图片大小不得超过1M",type:"warning"}),!1},upScuccess:function(e,t,l){this.fullscreenLoading=!1;var a=this,n="";if("image"===this.uploadType?n=t.response.result.urls[0]:this.uploadType,null!=n&&n.length>0){var o=n;a.addRange=a.$refs.myQuillEditor.quill.getSelection(),a.$refs.myQuillEditor.quill.insertEmbed(null!==a.addRange?a.addRange.index:0,a.uploadType,o,r.a.sources.USER)}else this.$message.error(a.uploadType+"插入失败");this.$refs.upload.clearFiles()},imgHandler:function(e){(this.addRange=this.$refs.myQuillEditor.quill.getSelection(),e)&&document.getElementById("imgInput").click();this.uploadType="image"},videoHandler:function(e){(this.addRange=this.$refs.myQuillEditor.quill.getSelection(),e)&&document.getElementById("imgInput").click();this.uploadType="video"}},computed:{editor:function(){return this.$refs.myQuillEditor.quill}},mounted:function(){this.serverPath=window.SERVER_PATH,this.$refs.myQuillEditor.quill.getModule("toolbar").addHandler("image",this.imgHandler),this.$refs.myQuillEditor.quill.getModule("toolbar").addHandler("video",this.videoHandler)},activated:function(){if(this.getPageType(),this.$route.params&&this.$route.params.data){var e=this.$route.params.data,t={url:e.url,title:e.title,content:e.content,pageType:e.page_type,id:e.id};this.postObj=t,this.originUrl=e.url,"view"==this.$route.params.type?this.disabled=!0:this.disabled=!1,this.getContent(e.id)}else this.postObj={url:"",title:"",content:"",pageType:1},this.disabled=!1,this.originUrl=""},components:{quillEditor:a.quillEditor}},s={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"add-news-page"},[l("el-row",{staticStyle:{"margin-bottom":"20px"}},[l("el-col",{attrs:{span:20}},[l("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1),e._v(" "),e.disabled?e._e():l("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[l("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.save(t)}}},[e._v("保存")])],1)],1),e._v(" "),l("el-form",{ref:"form",attrs:{inline:!0,"label-width":"100px",rules:e.rules,model:e.postObj}},[l("el-form-item",{attrs:{label:"外部URL",prop:"realName"}},[l("el-input",{attrs:{size:"small",placeholder:"请输入外部URL",disabled:e.disabled},model:{value:e.postObj.url,callback:function(t){e.$set(e.postObj,"url","string"==typeof t?t.trim():t)},expression:"postObj.url"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"预发布类型",prop:"pageType"}},[l("el-select",{ref:"pageType",attrs:{size:"small",disabled:e.disabled},model:{value:e.postObj.pageType,callback:function(t){e.$set(e.postObj,"pageType",t)},expression:"postObj.pageType"}},e._l(e.pageTypeList,function(e,t){return l("el-option",{key:t,attrs:{label:e.typeName,value:e.pageType}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"标题",prop:"title"}},[l("el-input",{attrs:{size:"small",placeholder:"请输入标题",disabled:e.disabled},model:{value:e.postObj.title,callback:function(t){e.$set(e.postObj,"title","string"==typeof t?t.trim():t)},expression:"postObj.title"}})],1)],1),e._v(" "),l("quill-editor",{ref:"myQuillEditor",attrs:{disabled:e.disabled},model:{value:e.postObj.content,callback:function(t){e.$set(e.postObj,"content","string"==typeof t?t.trim():t)},expression:"postObj.content"}}),e._v(" "),l("el-upload",{ref:"upload",staticClass:"upload",staticStyle:{display:"none"},attrs:{action:e.serverPath+"wallet/backmgr/uploadFile",name:"files",data:{type:"html"},"on-success":e.upScuccess,"before-upload":e.beforeUpload}},[l("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{size:"small",type:"primary",id:"imgInput","element-loading-text":"插入中,请稍候"}},[e._v("点击上传")])],1)],1)},staticRenderFns:[]};var i=l("C7Lr")(o,s,!1,function(e){l("8bra")},null,null);t.default=i.exports},"8bra":function(e,t){throw new Error("Module build failed: ModuleBuildError: Module build failed: Error: Cannot find module 'tslib'\n    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:594:15)\n    at Function.Module._load (internal/modules/cjs/loader.js:520:25)\n    at Module.require (internal/modules/cjs/loader.js:650:17)\n    at require (internal/modules/cjs/helpers.js:20:18)\n    at Object.<anonymous> (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_less@3.11.0@less\\dist\\less.cjs.js:3:13)\n    at Module._compile (internal/modules/cjs/loader.js:702:30)\n    at Object.Module._extensions..js (internal/modules/cjs/loader.js:713:10)\n    at Module.load (internal/modules/cjs/loader.js:612:32)\n    at tryModuleLoad (internal/modules/cjs/loader.js:551:12)\n    at Function.Module._load (internal/modules/cjs/loader.js:543:3)\n    at Module.require (internal/modules/cjs/loader.js:650:17)\n    at require (internal/modules/cjs/helpers.js:20:18)\n    at Object.<anonymous> (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_less@3.11.0@less\\index.js:1:80)\n    at Module._compile (internal/modules/cjs/loader.js:702:30)\n    at Object.Module._extensions..js (internal/modules/cjs/loader.js:713:10)\n    at Module.load (internal/modules/cjs/loader.js:612:32)\n    at runLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_webpack@3.12.0@webpack\\lib\\NormalModule.js:195:19)\n    at E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:367:11\n    at E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:172:11\n    at loadLoader (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\loadLoader.js:32:11)\n    at iteratePitchingLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:169:2)\n    at iteratePitchingLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:165:10)\n    at E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:176:18\n    at loadLoader (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\loadLoader.js:47:3)\n    at iteratePitchingLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:169:2)\n    at iteratePitchingLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:165:10)\n    at E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:176:18\n    at loadLoader (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\loadLoader.js:47:3)\n    at iteratePitchingLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:169:2)\n    at runLoaders (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_loader-runner@2.4.0@loader-runner\\lib\\LoaderRunner.js:365:2)\n    at NormalModule.doBuild (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_webpack@3.12.0@webpack\\lib\\NormalModule.js:182:3)\n    at NormalModule.build (E:\\20200210\\new\\wallet-backmgr\\node_modules\\_webpack@3.12.0@webpack\\lib\\NormalModule.js:275:15)")}});