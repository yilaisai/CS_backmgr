webpackJsonp([17],{w0TN:function(e,t){},zc4h:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),i=a.n(r),n={name:"currency-set",data:function(){var e=function(e,t,a){/^[0-9]+.?[0-9]*$/.test(t)?a():a(new Error(e.message))};return{ruleForm:{coinType:"",kingRewardRate:"",goldSilverRate:"",bronzeRewardRate:"",eachOneRate:""},sacTeamRewardList:[],teamName:"",teamId:"",server_path:"",pageTypeList:[],rules:{bronzeRewardRate:[{required:!0,message:"请输入数额",trigger:"blur"},{validator:e,message:"限额必须为数字"}],goldSilverRate:[{required:!0,message:"请输入数额",trigger:"blur"},{validator:e,message:"限额必须为数字"}],kingRewardRate:[{required:!0,message:"请输入数额",trigger:"blur"},{validator:e,message:"限额必须为数字"}],coinType:[{required:!0,message:"请选择币种",trigger:"change"},{message:"账数额必须为数字"}],eachOneRate:[{required:!0,message:"请输入数额",trigger:"blur"},{validator:e,message:"限额必须为数字"}]}}},methods:{onSubmit:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;var a=JSON.parse(i()(e.ruleForm));a.tranInFee=(e.ruleForm.tranInFee+e.tranInFeeUnit).trim(),a.tranOutFee=(e.ruleForm.tranOutFee+e.tranOutFeeUnit).trim(),e.$http.post("/cloud/team/backmgr/teamRewardSeting",{teamId:e.teamId,kingRewardRate:e.ruleForm.kingRewardRate,goldRewardRate:e.ruleForm.goldSilverRate,bronzeRewardRate:e.ruleForm.bronzeRewardRate,eachOneRate:e.ruleForm.eachOneRate}).then(function(t){e.$message({type:"success",message:"修改成功！"}),e.$router.go(-1)})})},addPrize:function(e,t){""!=e.coinName?""!=(e.amount+"").trim()?(this.sacTeamRewardList.push({coinName:"",amount:""}),"number"==typeof e.coinName&&this.$http.post("/cloud/team/backmgr/teamCoinSeting",{teamId:this.teamId,coinId:e.coinName,amount:e.amount}).then(function(e){})):this.$notify({message:"请输入币种的数量",type:"error"}):this.$notify({message:"请选择币种类型",type:"error"})},deleteIndex:function(e,t){for(var a=[],r=0;r<e.length;r++)r!=t&&a.push(e[r]);return a},deletePrize:function(e,t){var a=this,r=e.coinName;"number"!=typeof r&&(r=e.coinId),this.$http.post("/cloud/team/backmgr/delTeamCoinSeting",{teamId:this.teamId,coinId:r}).then(function(e){a.deleteIndex(a.sacTeamRewardList,t)})},getTeamRewardSeting:function(e){var t=this;this.$http.post("/cloud/team/backmgr/getTeamRewardSeting",{teamId:e}).then(function(e){t.ruleForm=e.result,t.sacTeamRewardList=e.result.sacTeamRewardCoinResultDtoList,t.ruleForm.coinType=t.sacTeamRewardList[0].coinName})},getCoinInfoList:function(){var e=this;this.$http.post("/cloud/coin/open/getCoinInfoList",{}).then(function(t){e.pageTypeList=t.result})}},activated:function(){if(this.getCoinInfoList(),this.server_path=SERVER_PATH,this.$route.params&&this.$route.params.data){var e=this.$route.params.data;this.teamName=e.teamName,this.teamId=e.teamId,this.getTeamRewardSeting(this.teamId)}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"set-prize"},[a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")])],1),e._v(" "),a("h2",[e._v(e._s(e.teamName)+"奖励设置")])],1),e._v(" "),a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"230px"}},[e._l(e.sacTeamRewardList,function(t,r){return a("el-form-item",{attrs:{label:e.teamName+"总奖励:",required:""}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"coinType"}},[a("el-select",{ref:"coinType",refInFor:!0,model:{value:t.coinName,callback:function(a){e.$set(t,"coinName",a)},expression:"teamReward.coinName"}},e._l(e.pageTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.coinName,value:e.coinId}})}))],1)],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:1}}),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{prop:"coinNumber"}},[a("el-input",{staticClass:"min-input",attrs:{clearable:"",size:"small",placeholder:"请输入数量"},model:{value:t.amount,callback:function(a){e.$set(t,"amount",a)},expression:"teamReward.amount"}})],1)],1),e._v(" "),a("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(a){e.deletePrize(t,r)}}},[e._v("删除")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:r==e.sacTeamRewardList.length-1,expression:"index == sacTeamRewardList.length - 1"}],staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(a){e.addPrize(t,r)}}},[e._v("添加")])],1)}),e._v(" "),a("el-form-item",{attrs:{label:"最强王者奖励百分比:",prop:"kingRewardRate"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{clearable:"",size:"small",placeholder:"请输入百分比"},model:{value:e.ruleForm.kingRewardRate,callback:function(t){e.$set(e.ruleForm,"kingRewardRate",t)},expression:"ruleForm.kingRewardRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"荣耀黄金+持续白银奖励百分比:",prop:"goldSilverRate",required:""}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",placeholder:"请输入百分比",clearable:""},model:{value:e.ruleForm.goldSilverRate,callback:function(t){e.$set(e.ruleForm,"goldSilverRate",t)},expression:"ruleForm.goldSilverRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"倔强青铜奖励百分比:",prop:"bronzeRewardRate"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{clearable:"",size:"small",placeholder:"请输入百分比"},model:{value:e.ruleForm.bronzeRewardRate,callback:function(t){e.$set(e.ruleForm,"bronzeRewardRate",t)},expression:"ruleForm.bronzeRewardRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总人数奖励百分比:",prop:"eachOneRate"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{clearable:"",size:"small",placeholder:"请输入百分比"},model:{value:e.ruleForm.eachOneRate,callback:function(t){e.$set(e.ruleForm,"eachOneRate",t)},expression:"ruleForm.eachOneRate"}})],1),e._v(" "),a("p",{staticClass:"total-prize"},[e._v("*各奖励百分比相加等于总奖励")]),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center",width:"80%","margin-top":"60px"},attrs:{size:"small"}},[a("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),a("el-button",{staticStyle:{width:"100px"},attrs:{type:"danger"},on:{click:function(t){e.$router.go(-1)}}},[e._v("取消")])],1)],2)],1)},staticRenderFns:[]};var o=a("VU/8")(n,l,!1,function(e){a("w0TN")},null,null);t.default=o.exports}});